"use strict";angular.module("bcApp",["ngCookies","ngSanitize","ngResource","ngRoute","LocalStorageModule"]).config(["$routeProvider","$locationProvider","localStorageServiceProvider",function(a,b,c){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/user",{templateUrl:"views/user.html",controller:"UserCtrl"}).otherwise({redirectTo:"/"}),c.setPrefix("bcApp").setNotify(!0,!0)}]).run(["$rootScope","$location","localStorageService","$http","apiurl",function(a,b,c,d,e){if(c.isSupported&&c.get("auth")){var f={id:c.get("id"),name:c.get("name")};d({method:"GET",withCredentials:!0,url:e+"org/"+f.id+"/user/"+f.name+".json",headers:{"Content-Type":"application/json; charset=utf-8"}}).success(function(c){a.currentUser={auth:!0,id:c.id,name:c.username},b.path("/")}).error(function(){a.currentUser=null,b.path("/")})}else a.currentUser=null,b.path("/")}]),angular.module("bcApp").controller("LoginCtrl",["$scope","$http","apiurl","$location","$rootScope","localStorageService",function(a,b,c,d,e,f){a.user={},a.error=!1,a.hideErr=function(){a.error=!1},a.doLogin=function(){a.submitted=!0;var g=JSON.stringify({username:a.user.name,password:a.user.password});b({method:"POST",withCredentials:!0,url:c+"auth",headers:{"Content-Type":"application/json; charset=utf-8"},data:g}).success(function(a){e.currentUser={auth:!0,id:a.id,name:a.username},f.isSupported&&(f.set("auth",!0),f.set("id",a.id),f.set("name",a.username)),d.path("/user")}).error(function(){e.currentUser=null,f.isSupported&&(f.remove("auth"),f.remove("id"),f.remove("name")),a.error=!0})}}]),angular.module("bcApp").controller("MainCtrl",["$scope",function(){}]),angular.module("bcApp").controller("NavbarCtrl",["$scope","$location","$http","$rootScope","apiurl","$timeout","localStorageService","$log",function(a,b,c,d,e,f,g,h){a.logout=function(){c({method:"GET",withCredentials:!0,url:e+"logout",headers:{"Content-Type":"application/json; charset=utf-8"}}),d.currentUser=null,g.isSupported&&(g.remove("auth"),g.remove("id"),g.remove("name")),f(function(){h.info("http://104.236.35.119/api/logout response 302 Moved Temporarily"),b.path("/")},1e3)}}]),angular.module("bcApp").controller("UserCtrl",["$scope","$http","apiurl","$rootScope","$location",function(a,b,c,d,e){function f(a,d){b({method:"GET",withCredentials:!0,url:c+"org/"+a.id+"/user/"+a.name+".json",headers:{"Content-Type":"application/json; charset=utf-8"}}).success(function(){return d.apply(null,arguments)}).error(function(){return d.apply(null)})}function g(a,d,e){b({method:"POST",withCredentials:!0,url:c+"user/"+a.id,headers:{"Content-Type":"application/json; charset=utf-8"},data:JSON.stringify(d)}).success(function(){return e.apply(null,arguments)}).error(function(){return e.apply(null)})}d.currentUser||e.path("/"),a.doLoad=function(){f(d.currentUser,function(b){b||e.path("/"),a.userdata=b,a.contentExist=!0,a.newdata={firstName:b.firstName,lastName:b.lastName,tel:{countryCode:b.tel.countryCode,areaCode:b.tel.areaCode,number:b.tel.number,extension:b.tel.extension},password:null}})},a.doEdit=function(){a.edit=!0},a.doSave=function(){null==a.newdata.password?a.error=!0:(a.edit=!1,g(d.currentUser,a.newdata,function(b){b&&a.doLoad()}))},a.doCancel=function(){a.edit=!1,a.error=!1,a.doLoad()},a.phoneToText=function(a){a=a||{};var b="";return b+=" + "+a.countryCode,b+=" ( "+a.areaCode,b+=" ) "+a.number,a.extension&&(b+=" ext: "+a.extension),b},a.userdata={},a.edit=!1,a.showJsonData=!1,a.contentExist=!1,a.error=!1,a.doLoad()}]),angular.module("bcApp").constant("apiurl","http://104.236.35.119/api/");