"use strict";angular.module("bcApp",["ngCookies","ngResource","ngRoute"]).config(["$routeProvider","$locationProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/user",{templateUrl:"views/user.html",controller:"UserCtrl"}).when("/buyers",{templateUrl:"views/buyers.html",controller:"BuyersCtrl"}).otherwise({redirectTo:"/buyers"})}]).run(["$rootScope","$location","$http","apiurl",function(a,b){b.path("/buyers")}]),angular.module("bcApp").controller("LoginCtrl",["$scope","$http","apiurl","$location","$rootScope",function(a,b,c,d,e){a.user={name:"test@odesk2.com",password:"password"},a.error=!1,a.hideErr=function(){a.error=!1},a.doLogin=function(){a.submitted=!0;var f=JSON.stringify({username:a.user.name,password:a.user.password});b({method:"POST",withCredentials:!0,url:c+"auth",headers:{"Content-Type":"application/json; charset=utf-8"},data:f}).success(function(a){e.currentUser={auth:!0,id:a.id,name:a.username},d.path("/user")}).error(function(){e.currentUser=null,a.error=!0})}}]),angular.module("bcApp").controller("MainCtrl",["$scope",function(){}]),angular.module("bcApp").controller("NavbarCtrl",["$scope","$location","$http","$rootScope","apiurl","$timeout",function(a,b,c,d,e,f){a.logout=function(){c({method:"GET",withCredentials:!0,url:e+"logout",headers:{"Content-Type":"application/json","Cache-Control":"no-cache"}}),d.currentUser=null,f(function(){b.path("/")},1e3)}}]),angular.module("bcApp").controller("UserCtrl",["$scope","$http","apiurl","$rootScope","$location","$timeout",function(a,b,c,d,e,f){function g(a,d){b({method:"GET",withCredentials:!0,url:c+"org/"+a.id+"/user/"+a.name+".json",headers:{"Content-Type":"application/json; charset=utf-8"}}).success(function(){return d.apply(null,arguments)}).error(function(){return d.apply(null)})}function h(a,d,e){b({method:"POST",withCredentials:!0,url:c+"user/"+a.id,headers:{"Content-Type":"application/json; charset=utf-8"},data:JSON.stringify(d)}).success(function(){return e.apply(null,arguments)}).error(function(){return e.apply(null)})}d.currentUser||e.path("/"),a.doLoad=function(){g(d.currentUser,function(b){b||e.path("/"),a.userdata=b,a.contentExist=!0,a.newdata={firstName:b.firstName,lastName:b.lastName,tel:{countryCode:b.tel.countryCode,areaCode:b.tel.areaCode,number:b.tel.number,extension:b.tel.extension},password:null},a.teltext=a.phoneToText(b.tel)})},a.doEdit=function(){a.edit=!0},a.doSave=function(){null===a.newdata.password?a.error=!0:(a.edit=!1,h(d.currentUser,a.newdata,function(b){b&&a.doLoad()}))},a.doCancel=function(){a.edit=!1,a.error=!1,a.doLoad()},a.phoneToText=function(a){a=a||{countryCode:"",areaCode:"",number:"",extension:""};var b="";return b+="+ "+a.countryCode,a.areaCode&&(b+=" ( "+a.areaCode),a.number&&(b+=" ) "+a.number.toString().split("").slice(0,3).join("")),a.number.toString().length>3&&(b+="-"+a.number.toString().split("").slice(3).join("")),a.extension&&(b+=" ext: "+a.extension),b},a.textToPhone=function(a){var b={};b.countryCode="",b.areaCode="",b.number="",b.extension="";var c=(""+a).replace(/[^0-9]/g,"").split("");return b.countryCode="1",b.areaCode=c.slice(1,4).join(""),b.number=c.slice(4,11).join(""),b.extension=c.slice(11,15).join(""),b},a.checkphone=function(){a.newdata.tel=a.textToPhone(a.teltext),f(function(){a.teltext=a.phoneToText(a.newdata.tel)},0)},a.userdata={},a.edit=!1,a.showJsonData=!1,a.contentExist=!1,a.error=!1,a.doLoad()}]);var unique=function(a,b){var c=[];return a.forEach(function(a){var d=a[b];-1==c.indexOf(d)&&c.push(d)}),c};angular.module("bcApp").controller("BuyersCtrl",["$scope","$http","$filter","$q",function(a,b,c){a.btstyle={},a.search={},a.show={},a.nameList=[],b.get("data.json").then(function(b){a.contactList=c("orderBy")(b.data,"name"),a.contactList.forEach(function(a){a.ngr=a.name.slice(0,1)}),a.searchUpdate()}),a.searchUpdate=function(){a.nameList=c("filter")(a.contactList,a.search),a.letters=unique(a.nameList,"ngr")},a.showUpdate=function(b){a.show._id=b,"_"===b?(a.btstyle.big=" ",a.btstyle.small="col-sm-4"):(a.btstyle.big="hidden-xs col-sm-4 leftcol",a.btstyle.small=" ")},a.showUpdate("_")}]).directive("buyerContact",function(){return{restrict:"E",templateUrl:"./views/drct/buyerContact.html"}}),angular.module("bcApp").constant("apiurl","http://104.236.35.119/api/");